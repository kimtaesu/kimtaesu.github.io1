<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Docker를 이용한 Deep Learning 환경 구성</title>
    <meta name="description" content="A simple, whitespace, helvetica based portfolio theme.
">

    <link rel="stylesheet" href="/css/main.css">
    <link rel="canonical" href="http://localhost:4000/metal/2016-05-02-docker/">

    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
    <line rel="stylesheet" href="/css/solarized_light.css"
    
    <!-- mathjax config similar to math.stackexchange -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      jax: ["input/TeX", "output/HTML-CSS"],
      tex2jax: {
        inlineMath: [ ['$', '$'] ],
        displayMath: [ ['$$', '$$']],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      },
      messageStyle: "none",
      "HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"] }
    });
    </script>
    <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
</head>


  <body>
    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" display="none" version="1.1"><defs><symbol id="icon-menu" viewBox="0 0 1024 1024"><path class="path1" d="M128 213.333h768q17.667 0 30.167 12.5t12.5 30.167-12.5 30.167-30.167 12.5h-768q-17.667 0-30.167-12.5t-12.5-30.167 12.5-30.167 30.167-12.5zM128 725.333h768q17.667 0 30.167 12.5t12.5 30.167-12.5 30.167-30.167 12.5h-768q-17.667 0-30.167-12.5t-12.5-30.167 12.5-30.167 30.167-12.5zM128 469.333h768q17.667 0 30.167 12.5t12.5 30.167-12.5 30.167-30.167 12.5h-768q-17.667 0-30.167-12.5t-12.5-30.167 12.5-30.167 30.167-12.5z"/></symbol><symbol id="icon-search" viewBox="0 0 951 1024"><path class="path1" d="M658.286 475.429q0-105.714-75.143-180.857t-180.857-75.143-180.857 75.143-75.143 180.857 75.143 180.857 180.857 75.143 180.857-75.143 75.143-180.857zM950.857 950.857q0 29.714-21.714 51.429t-51.429 21.714q-30.857 0-51.429-21.714l-196-195.429q-102.286 70.857-228 70.857-81.714 0-156.286-31.714t-128.571-85.714-85.714-128.571-31.714-156.286 31.714-156.286 85.714-128.571 128.571-85.714 156.286-31.714 156.286 31.714 128.571 85.714 85.714 128.571 31.714 156.286q0 125.714-70.857 228l196 196q21.143 21.143 21.143 51.429z"/></symbol><symbol id="icon-email" viewBox="0 0 1024 1024"><path class="path1" d="M950.857 859.429v-438.857q-18.286 20.571-39.429 37.714-153.143 117.714-243.429 193.143-29.143 24.571-47.429 38.286t-49.429 27.714-58.571 14h-1.143q-27.429 0-58.571-14t-49.429-27.714-47.429-38.286q-90.286-75.429-243.429-193.143-21.143-17.143-39.429-37.714v438.857q0 7.429 5.429 12.857t12.857 5.429h841.143q7.429 0 12.857-5.429t5.429-12.857zM950.857 258.857v-14t-0.286-7.429-1.714-7.143-3.143-5.143-5.143-4.286-8-1.429h-841.143q-7.429 0-12.857 5.429t-5.429 12.857q0 96 84 162.286 110.286 86.857 229.143 181.143 3.429 2.857 20 16.857t26.286 21.429 25.429 18 28.857 15.714 24.571 5.143h1.143q11.429 0 24.571-5.143t28.857-15.714 25.429-18 26.286-21.429 20-16.857q118.857-94.286 229.143-181.143 30.857-24.571 57.429-66t26.571-75.143zM1024 237.714v621.714q0 37.714-26.857 64.571t-64.571 26.857h-841.143q-37.714 0-64.571-26.857t-26.857-64.571v-621.714q0-37.714 26.857-64.571t64.571-26.857h841.143q37.714 0 64.571 26.857t26.857 64.571z"/></symbol><symbol id="icon-close" viewBox="0 0 805 1024"><path class="path1" d="M741.714 755.429q0 22.857-16 38.857l-77.714 77.714q-16 16-38.857 16t-38.857-16l-168-168-168 168q-16 16-38.857 16t-38.857-16l-77.714-77.714q-16-16-16-38.857t16-38.857l168-168-168-168q-16-16-16-38.857t16-38.857l77.714-77.714q16-16 38.857-16t38.857 16l168 168 168-168q16-16 38.857-16t38.857 16l77.714 77.714q16 16 16 38.857t-16 38.857l-168 168 168 168q16 16 16 38.857z"/></symbol><symbol id="icon-twitter" viewBox="0 0 951 1024"><path class="path1" d="M925.714 233.143q-38.286 56-92.571 95.429 0.571 8 0.571 24 0 74.286-21.714 148.286t-66 142-105.429 120.286-147.429 83.429-184.571 31.143q-154.857 0-283.429-82.857 20 2.286 44.571 2.286 128.571 0 229.143-78.857-60-1.143-107.429-36.857t-65.143-91.143q18.857 2.857 34.857 2.857 24.571 0 48.571-6.286-64-13.143-106-63.714t-42-117.429v-2.286q38.857 21.714 83.429 23.429-37.714-25.143-60-65.714t-22.286-88q0-50.286 25.143-93.143 69.143 85.143 168.286 136.286t212.286 56.857q-4.571-21.714-4.571-42.286 0-76.571 54-130.571t130.571-54q80 0 134.857 58.286 62.286-12 117.143-44.571-21.143 65.714-81.143 101.714 53.143-5.714 106.286-28.571z"/></symbol><symbol id="icon-facebook" viewBox="0 0 585 1024"><path class="path1" d="M548 6.857v150.857h-89.714q-49.143 0-66.286 20.571t-17.143 61.714v108h167.429l-22.286 169.143h-145.143v433.714h-174.857v-433.714h-145.714v-169.143h145.714v-124.571q0-106.286 59.429-164.857t158.286-58.571q84 0 130.286 6.857z"/></symbol><symbol id="icon-rss" viewBox="0 0 805 1024"><path class="path1" d="M219.429 768q0 45.714-32 77.714t-77.714 32-77.714-32-32-77.714 32-77.714 77.714-32 77.714 32 32 77.714zM512 838.286q1.143 16-9.714 27.429-10.286 12-26.857 12h-77.143q-14.286 0-24.571-9.429t-11.429-23.714q-12.571-130.857-105.429-223.714t-223.714-105.429q-14.286-1.143-23.714-11.429t-9.429-24.571v-77.143q0-16.571 12-26.857 9.714-9.714 24.571-9.714h2.857q91.429 7.429 174.857 46t148 103.714q65.143 64.571 103.714 148t46 174.857zM804.571 839.429q1.143 15.429-10.286 26.857-10.286 11.429-26.286 11.429h-81.714q-14.857 0-25.429-10t-11.143-24.286q-6.857-122.857-57.714-233.429t-132.286-192-192-132.286-233.429-58.286q-14.286-0.571-24.286-11.143t-10-24.857v-81.714q0-16 11.429-26.286 10.286-10.286 25.143-10.286h1.714q149.714 7.429 286.571 68.571t243.143 168q106.857 106.286 168 243.143t68.571 286.571z"/></symbol><symbol id="icon-google-plus" viewBox="0 0 951 1024"><path class="path1" d="M420 454.857q0 20.571 18.286 40.286t44.286 38.857 51.714 42 44 59.429 18.286 81.143q0 51.429-27.429 98.857-41.143 69.714-120.571 102.571t-170.286 32.857q-75.429 0-140.857-23.714t-98-78.571q-21.143-34.286-21.143-74.857 0-46.286 25.429-85.714t67.714-65.714q74.857-46.857 230.857-57.143-18.286-24-27.143-42.286t-8.857-41.714q0-20.571 12-48.571-26.286 2.286-38.857 2.286-84.571 0-142.571-55.143t-58-139.714q0-46.857 20.571-90.857t56.571-74.857q44-37.714 104.286-56t124.286-18.286h238.857l-78.857 50.286h-74.857q42.286 36 64 76t21.714 91.429q0 41.143-14 74t-33.714 53.143-39.714 37.143-34 35.143-14 37.714zM336.571 400q21.714 0 44.571-9.429t37.714-24.857q30.286-32.571 30.286-90.857 0-33.143-9.714-71.429t-27.714-74-48.286-59.143-66.857-23.429q-24 0-47.143 11.143t-37.429 30q-26.857 33.714-26.857 91.429 0 26.286 5.714 55.714t18 58.857 29.714 52.857 42.857 38.286 55.143 14.857zM337.714 898.857q33.143 0 63.714-7.429t56.571-22.286 41.714-41.714 15.714-62.286q0-14.286-4-28t-8.286-24-15.429-23.714-16.857-20-22-19.714-20.857-16.571-23.714-17.143-20.857-14.857q-9.143-1.143-27.429-1.143-30.286 0-60 4t-61.429 14.286-55.429 26.286-39.143 42.571-15.429 60.286q0 40 20 70.571t52.286 47.429 68 25.143 72.857 8.286zM800.571 398.286h121.714v61.714h-121.714v125.143h-60v-125.143h-121.143v-61.714h121.143v-124h60v124z"/></symbol><symbol id="icon-angle-down" viewBox="0 0 658 1024"><path class="path1" d="M614.286 420.571q0 7.429-5.714 13.143l-266.286 266.286q-5.714 5.714-13.143 5.714t-13.143-5.714l-266.286-266.286q-5.714-5.714-5.714-13.143t5.714-13.143l28.571-28.571q5.714-5.714 13.143-5.714t13.143 5.714l224.571 224.571 224.571-224.571q5.714-5.714 13.143-5.714t13.143 5.714l28.571 28.571q5.714 5.714 5.714 13.143z"/></symbol><symbol id="icon-github-alt" viewBox="0 0 951 1024"><path class="path1" d="M365.714 694.857q0 22.857-7.143 46.857t-24.571 43.429-41.429 19.429-41.429-19.429-24.571-43.429-7.143-46.857 7.143-46.857 24.571-43.429 41.429-19.429 41.429 19.429 24.571 43.429 7.143 46.857zM731.429 694.857q0 22.857-7.143 46.857t-24.571 43.429-41.429 19.429-41.429-19.429-24.571-43.429-7.143-46.857 7.143-46.857 24.571-43.429 41.429-19.429 41.429 19.429 24.571 43.429 7.143 46.857zM822.857 694.857q0-68.571-39.429-116.571t-106.857-48q-23.429 0-111.429 12-40.571 6.286-89.714 6.286t-89.714-6.286q-86.857-12-111.429-12-67.429 0-106.857 48t-39.429 116.571q0 50.286 18.286 87.714t46.286 58.857 69.714 34.286 80 16.857 85.143 4h96q46.857 0 85.143-4t80-16.857 69.714-34.286 46.286-58.857 18.286-87.714zM950.857 594.286q0 118.286-34.857 189.143-21.714 44-60.286 76t-80.571 49.143-97.143 27.143-98 12.571-95.429 2.571q-44.571 0-81.143-1.714t-84.286-7.143-87.143-17.143-78.286-29.429-69.143-46.286-49.143-65.714q-35.429-70.286-35.429-189.143 0-135.429 77.714-226.286-15.429-46.857-15.429-97.143 0-66.286 29.143-124.571 61.714 0 108.571 22.571t108 70.571q84-20 176.571-20 84.571 0 160 18.286 60-46.857 106.857-69.143t108-22.286q29.143 58.286 29.143 124.571 0 49.714-15.429 96 77.714 91.429 77.714 227.429z"/></symbol><symbol id="icon-linkedin" viewBox="0 0 1792 1792"><path class="path1" d="M477 625v991h-330v-991h330zm21-306q1 73-50.5 122t-135.5 49h-2q-82 0-132-49t-50-122q0-74 51.5-122.5t134.5-48.5 133 48.5 51 122.5zm1166 729v568h-329v-530q0-105-40.5-164.5t-126.5-59.5q-63 0-105.5 34.5t-63.5 85.5q-11 30-11 81v553h-329q2-399 2-647t-1-296l-1-48h329v144h-2q20-32 41-56t56.5-52 87-43.5 114.5-15.5q171 0 275 113.5t104 332.5z"/></symbol></defs></svg>
    <header class="site-header">

  <div class="wrapper">
    <div class="site-title" >*kimtaesu</div>
      
    <nav class="site-nav">
        
      <div class="trigger">
        <!-- kimtaesu instead of blog -->
        <a class="page-link" href="/">blog</a>

        
          
          <a class="page-link" href="/about/">about</a>
          
        
          
          <a class="page-link" href="/android">Android</a>
          
        
          
        
          
        
          
          <a class="page-link" href="/kotlin">Kotlin</a>
          
        
          
        
          
          <a class="page-link" href="/python">Python</a>
          
        
          
          <a class="page-link" href="/self-improvement/">Self-Improve</a>
          
        

      </div>
    </nav>
  </div>

</header>



    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">Docker를 이용한 Deep Learning 환경 구성</h1>
    <p class="post-meta">May 2, 2016</p>
  </header>

  <article class="post-content">
    <p>Docker를 기반으로 Deep Learning 환경을 구축해보자.</p>

<p>Docker를 이용하여 개발 환경을 구성할 경우, 전체 시스템에서 개발 환경을 분리해서 관리할 수 있고, 필요할 경우 다른 장비로 옮기거나 다른 이들과 개발환경을 공유하는 것이 가능하다는 이점이 있다. 실제로 Udacity의 Deep Learning 강좌의 경우 강의에 사용하는 Tensorflow가 설치된 docker container를 배포하고 있어서, 학생들로 하여금 개발환경 구축에 대한 부담없이 Deep Learning을 시작할 수 있도록 도와주고 있다. 개인적으로는 개발 환경과 작업하고 있는 source code를 분리해서 관리하고, 개발 환경을 정리하는 용도로 활용하고 있다.</p>

<p>여기서는 Docker가 무엇이고, 어떻게 사용한다고 하기 보다는, 내가 사용하는 Docker에 대한 사례를 소개하는 것을 중점으로 한다.</p>

<p>먼저 Deep Learning을 위해서 CUDA가 설치된 Linux 환경을 이용할 것이다. 없다면 CUDA가 가능한 container를 가져오는 절차를 건너뛰어도 무방하다. Linux에서 CUDA 환경이 구축되지 않았다면, <a href="/cuda/2016-02-29-cuda-linux/">Linux 환경에서 CUDA 개발환경 구축</a> 문서를 참조하자.</p>

<h1 id="docker-설치-debianubuntu">Docker 설치 (Debian/Ubuntu)</h1>

<p><a href="https://docs.docker.com/engine/installation/linux/debian/">Docker Document</a>에 있는 것을 참조하였다. 다른 리눅스 버전이라도 링크된 문서를 따라가 해당 내용을 참고하면 된다.</p>

<h2 id="repository-update">Repository Update</h2>

<p>Docker Repository를 등록한다.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="gp">$ </span>apt-get update
<span class="gp">$ </span>apt-get install apt-trasport-https ca-certificate
<span class="gp">$ </span>apt-key adv --keyserver hkp://p80.pool.sks-keyservers.net:80 --recv-keys 58118E89F3A912897C070ADBF76221572C52609D</code></pre></figure>

<p>debian 8.0 (jessie)라면 다음과 같이 쉘에 입력한다. 다른 버전에 대해서는 <em>debian-jessie</em> 외에 다른 배포한 및 버전을 지정해 주어야 한다.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="gp">$ </span>sudo <span class="nb">echo</span> <span class="s1">'deb https://apt.dockerproject.org/repo debian-jessie main'</span> &gt; /etc/apt/sources.list.d/docker/list</code></pre></figure>

<p>이후 Repository를 업데이트 한다.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="gp">$ </span>sudo apt-get update <span class="o">&amp;&amp;</span> sudo apt-get upgrade</code></pre></figure>

<h2 id="docker-설치">Docker 설치</h2>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="gp">$ </span>sudo apt-get install docker-engine</code></pre></figure>

<p>Docker를 사용하기 위해서는 항상 <strong>root</strong>이어야만 한다. 하지만 docker group을 추가하고, group내 user를 추가함으로서 root가 아니어도 docker를 사용할 수 있도록 할 수 있다.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="gp">$ </span>sudo groupadd docker
<span class="gp">$ </span>sudo gpasswd -a <span class="k">$(</span>USER<span class="k">)</span> docker
<span class="gp">$ </span>sudo service docker restart</code></pre></figure>

<h1 id="nvidia-cuda-이미지-설치">NVIDIA CUDA 이미지 설치</h1>

<h2 id="dockerfile-구성">Dockerfile 구성</h2>

<p>Docker에서 CUDA를 이용하기 위해서는, Base가 되는 Linux 시스템 뿐만 아니라 Docker Image에서도 CUDA를 사용할 수 있어야 한다. Docker에서 CUDA를 사용할 수 있는 Dockerfile은 NVIDIA에서 공개한 <a href="https://github.com/NVIDIA/nvidia-docker">NVIDIA Docker</a>를 사용할 것이므로, 큰 어려움 없이 Image를 구성할 수 있다.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># Repository clone</span>
<span class="gp">$ </span>git clone https://github.com/NVIDIA/nvidia-docker</code></pre></figure>

<p>다만 몇가지 변경을 해주어야 하는데 githum에 있는 데로 하면, 이 글을 쓰고 있는 날짜 기준(2016년 5월 2일)으로 지원하지 않는 docker 버전이라고 나온다. 여하튼 Debian 배포판을 이용하는, CUDA가 가능한 docker image를 만들기 위해 Repository를 받아서 다음과 같이 수정을 하였다.</p>

<p>만약 ubuntu를 그대로 이용하겠다면 다음 내용을 건너뛰고 Image Build로 넘어가면 된다.</p>

<h2 id="debian-기반-dockerfile-build-환경-구성">Debian 기반 Dockerfile build 환경 구성</h2>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># Ubuntu를 기준으로 Debian 기반 Dockerfile을 구성한다.</span>
<span class="gp">$ </span>cp -R ubuntu-14.04 debian

<span class="c"># Debian으로 OS 변경</span>
<span class="gp">$ </span><span class="nb">cd </span>nvidia-docker
<span class="gp">$ </span>find ./debian -name <span class="s2">"Dockerfile"</span> -exec perl -pi -e <span class="s1">'s/ubuntu:14.04/debian:latest/g'</span> <span class="o">{}</span> <span class="se">\;</span></code></pre></figure>

<h2 id="docker-image-빌드">Docker Image 빌드</h2>

<p><strong>nvidia-docker</strong> 디렉토리에서 진행한다.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="gp">$ </span>de debian/cuda
<span class="gp">$ </span>make 7.5-cudnn4-devel</code></pre></figure>

<p>선택가능한 옵션이 많지만, 여기서는 <strong>cuda 7.5-devel-cudnn4</strong>로 하였다.
Makefile의 의존관계를 살펴보면 알겠지만, 위 옵션을 선택하는 경우, CUDA 7.5-runtime &gt; devel &gt; cudnn4 순으로 빌드가 이뤄진다. Dockerfile를 컴파일하는데 make가 사용되는 이유는 전적으로 Dockerfile이 include를 지원하지 않기 때문이다. 앞으로도 docker는 Dockerfile 내에 Dockerfile을 include 하지 않을 것이라 한다.</p>

<p>build가 완료된다면 의존관계에 따라 복수의 image가 생성되는 것을 확인할 수 있다.
<img class="col three" src="/images/201605/Docker%20images.png" /></p>

<h2 id="docker-image-실행">Docker Image 실행</h2>

<p>내가 선호하는 Docker image의 실행구성은 다음과 같다.</p>

<p><img class="col two center" src="/images/201605/Docker&amp;Linux.png" /></p>

<p>즉, Docker Container 내에 내가 작성한 Code를 저장하지 않도록 하는 것이다. 이렇게 하였을 때 몇가지 이득이 있다.</p>

<ol>
  <li>Docker Container를 언제든지 종료할 수 있다.</li>
  <li>Docker를 실행하지 않고 Source Code에 접근할 수 있다.</li>
  <li>SouceCode와 Cloud 서비스를 연동하여 파일을 외부에서 자유롭게 관리할 수 있다.</li>
  <li>어떤 Container에 파일을 작업했었는지 찾을 필요가 없다.</li>
</ol>

<p>다른 더 좋은 구성이 있으면 따르겠지만 현재 내가 하는 선에서는 이것이 최선으로 보인다.</p>

<p>이러한 방법으로 실행하기 위해서 <strong>-v</strong> docker option을 사용한다. <strong>-v</strong> 옵션은 docker를 실행할 때 지정된 directory와 image 내의 지정된 dicectory를 공유 공간으로 하여 양쪽에서 접근 및 수정을 가능하게 해준다.</p>

<p>실제 내가 사용하는 명령은 다음과 같다. 각 부분에 대한 설명은 개발 환경 구성까지 마친 후 상세히 설명할 것이다.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">docker run -p 8888:8888 -it -v <span class="s2">"</span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span><span class="s2">:/workspace"</span> --rm metal/ml /bin/zsh</code></pre></figure>

<h1 id="개발-환경-구성">개발 환경 구성</h1>

<p>드디어 Deep Learning을 시험해 볼 수 있는 개발환경을 구축하는 단계로 왔다.</p>

<p>첨부된 Dockerfile은 크게 다음과 같은 구성을 갖고 있다.</p>

<ol>
  <li>Python2, Python3, Octave 설치</li>
  <li>개발 환경 설치 (build-essential, git, vim, wget, curl, lapack, blas 등등)</li>
  <li>pandas, pip, cython, scikit_learn, jupyter 등 설치</li>
  <li>jupyter 실행 script 추가, jupyter kernel 설치, jupyter 테마 설치</li>
  <li>zsh 설치</li>
</ol>

<p>파일의 내용은 다음을 참고한다.
<a href="">Dockerfile</a>
<a href="">notebook.sh</a></p>

<p>위 두 파일을 동일한 경로에 위치시키고, 다음과 같시 dockerfile을 build 한다. image의 이름은 원하는 아무 이름을 써도 무방하다.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">docker build -t metal/default .</code></pre></figure>

<h3 id="docker-실행">Docker 실행</h3>

<p>컴파일이 완료되었다면 정상적으로 jupyter를 포함한 설치한 개발 환경이 잘 동작하는지 확인해보자.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="gp">$ </span>docker run -p 8888:8888 -it -v <span class="s2">"</span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span><span class="s2">:/workspace"</span> --rm metal/default /bin/zsh

<span class="c"># Docker 내부에서 실행</span>
<span class="gp">$ </span>/notebook.sh</code></pre></figure>

<p>docker 명령어의 풀이는 다음과 같다.</p>

<table>
  <tbody>
    <tr>
      <td>docker run</td>
      <td>-p 8888:8888</td>
      <td>-it</td>
      <td>-v “$(pwd):/workspace”</td>
      <td>–rm metal/default</td>
      <td>/bin/zsh</td>
    </tr>
    <tr>
      <td>image 실행</td>
      <td>jupyter에서 사용할 8888 포트 공개</td>
      <td>interactive mode</td>
      <td>현재 경로를 docker container의 /workspace에 동기화</td>
      <td>metal/default 이미지 참조</td>
      <td>zsh를 기본 프로그램으로 실행</td>
    </tr>
  </tbody>
</table>

<p><br /></p>

<h1 id="deep-learning-libary-설치">Deep Learning Libary 설치</h1>
<p>이제 Deep Learning Library인 Theano와 Tensorflow를 설치해보자.</p>

<h3 id="dockerfile-생성">Dockerfile 생성</h3>

<p>아래와 같이 Dockerfile을 생성한다.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">FROM metal/default

<span class="c"># install tensorflow</span>
RUN aptitude install curl --without-recommends <span class="o">&amp;&amp;</span><span class="se">\</span>
    curl -O https://storage.googleapis.com/tensorflow/linux/cpu/tensorflow-0.7.1-cp27-none-linux_x86_64.whl <span class="o">&amp;&amp;</span><span class="se">\</span>
    pip install --upgrade tensorflow-0.8.0-cp27-none-linux_x86_64.whl <span class="o">&amp;&amp;</span><span class="se">\</span>
    rm tensorflow-0.8.0-cp27-none-linux_x86_64.whl <span class="o">&amp;&amp;</span><span class="se">\</span>
    pip install -U scikit-learn

<span class="c"># install theano</span>
RUN aptitude install liblapack-dev libblas-dev gfortran --without-recommends -y <span class="o">&amp;&amp;</span><span class="se">\</span>
    pip install --upgrade git+git://github.com/Theano/Theano.git <span class="o">&amp;&amp;</span><span class="se">\</span>
    theano-nose</code></pre></figure>

<h3 id="docker-image-빌드-및-실행">Docker image 빌드 및 실행</h3>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># 빌드</span>
<span class="gp">$ </span>docker build -t metal/ml .

<span class="c"># 실행</span>
<span class="gp">$ </span>docker run -p 8888:8888 -it -v <span class="s2">"</span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span><span class="s2">:/workspace"</span> --rm metal/dl /bin/zsh</code></pre></figure>

<p>각 라이브러리의 예제를 가져와서 실행해보면 잘 동작 할 것이다.</p>

  </article>

  <section class="share">
    <h3>Share</h3>
    <a aria-label="Share on Twitter" href="https://twitter.com/intent/tweet?text=&quot;&quot;%20http://localhost:4000/metal/2016-05-02-docker/%20via%20&#64;&hashtags=Docker,CUDA,"
    onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;" title="Share on Twitter">
        <svg class="icon icon-twitter"><use xlink:href="#icon-twitter"></use></svg>
    </a>
    <a aria-label="Share on Facebook"href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/metal/2016-05-02-docker/"
    onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;" title="Share on Facebook">
        <svg class="icon icon-facebook"><use xlink:href="#icon-facebook"></use></svg>
    </a>
    <a aria-label="Share on Google Plus" href="https://plus.google.com/share?url=http://localhost:4000/metal/2016-05-02-docker/"
    onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;" title="Share on Google+">
        <svg class="icon icon-google-plus"><use xlink:href="#icon-google-plus"></use></svg>
    </a>
</section>
  <section class="comments">
    <h3>Comments</h3>
    <div id="disqus_thread"></div>
</section>
<script type="text/javascript">
    var disqus_loaded = false;

    function load_disqus()
    {
        disqus_loaded = true;
        var disqus_shortname = '';
        var disqus_title = '';
        var disqus_url = '/metal/2016-05-02-docker/';
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        var ldr = document.getElementById('disqus_loader');
    };
    window.onscroll = function(e) {
        if ((window.innerHeight + window.scrollY) >= (document.body.offsetHeight - 800)) {
            //hit bottom of page
            if (disqus_loaded==false)
                load_disqus()
        }
    };
</script>

</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">
  	<p>Powered by <a href="http://jekyllrb.com" target="_blank">Jekyll</a> and is hosted on <a href="https://github.com" target="_blank">Github</a>.  Theme from <a href="https://github.com/bogoli/-folio" target="_blank">folio</a> by Lia Bogoev, MIT Licence. &#169; 2016.</p>
  </div>

</footer>


  </body>

</html>
